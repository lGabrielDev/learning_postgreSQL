#  Aggregate Function

S√£o func√µes/methods para manipular queries.

<br>
<hr>

## Requirements

* Crie a seguinte table no [mockaroo](https://www.mockaroo.com/):

```sql
CREATE TABLE IF NOT EXISTS tb_funcionarios(
    employee_id SERIAL PRIMARY KEY,
    first_name VARCHAR(40) NOT NULL,
    role VARCHAR(40) NOT NULL,
    salary INTEGER NOT NULL,
    country VARCHAR(40) NOT NULL
);
```

Os `INSERT INTO` que voc√™ vai colocar s√£o esses:

* **employee_id** -> n√£o precisa preencher, pois √© SERIAL/AUTO_INCREMENT

* **first_name** -> nome comum

* **role** -> Cargo ('Dev Junior', 'Dev Senior', 'Dev Pleno', 'Estagi√°rio')

* **salary** -> Sal√°rio dos empregados

* **country** -> ('Germany','Brazil','Italy','Spain','United States')

<br>

üí° Nos campos **role** and **country**, crie uma **Custom List**.

<br>

üí° Para deixar o sal√°rio certinho, basta dar um **UPDATE SET** nos sal√°rios:
    
- Estagiario --> 1500
- Dev Jr --> 2500
- Dev Pleno --> 3000
- Dev Senior --> 4000

<br>
<hr>

## Principais functions

| method/function | description |
| :---            | :---:       |
|COUNT            | Contar      |
|SUM              | Soma        |
|AVG              | M√©dia       | 
|MAX              | M√°ximo      |
|MIN              | M√≠nimo      |


<br>
<hr>

### AVG
:pencil2: Tire a **m√©dia** de sal√°rio dos funcion√°rios com cargo '**Dev Senior**'

```sql
SELECT
    AVG(salary) AS "M√©dia sal√°rio"
FROM
    tb_funcionarios
WHERE
    role = 'Dev Senior';
```

<br>

Para arredondar o valor, usamos o `ROUND()`:

```sql
SELECT
    ROUND(AVG(d.salary), 0)  "M√©dia de sal√°rio"
FROM
    tb_devs d
WHERE
    d.role = 'Dev Senior'
```

<br>
<hr>

### MAX and MIN
:pencil2: Fa√ßa uma query e traga o **menor** e o **maior** sal√°rio dos funcion√°rios com cargo '**Estagi√°rio**'

```sql
SELECT
    MIN(tf.salary) "menor salario dev Estagiario",
    MAX(tf.salary) "Maior salario dev Estagiario"
FROM
    tb_funcionarios tf
WHERE
    tf.role = 'Estagiario';
```

<br>

Para trazer o menor valor e mostrar todos os campos, √© s√≥ dar um `SELECT` e ordenar o sal√°rio de forma `ASC`, **limitando** o n√∫mero de rows.

```sql
SELECT
    employee_id AS "id",
    first_name AS "name",
    country AS "pa√≠s",
    salary AS "Menor sal√°rio"
FROM
    tb_funcionarios
ORDER BY
    salary ASC
LIMIT 1;
```

<br>
<hr>

### COUNT
Retorna a **quantidade de rows** de uma determinada column

<br>

#### Quantidade de rows em um campo espec√≠fico:
:pencil2: Fa√ßa uma query e retorne quantas linhas tem no campo **country**

```sql
SELECT
    COUNT(country) AS "Quantidade de rows"
FROM
    tb_funcionarios;
```

<br>

#### Quantidade de rows da tabela inteira:
```sql
SELECT
    COUNT(*) AS "Quantidade de rows da table"
FROM
    tb_funcionarios;
```

<br>

#### Quantiade de rows de um campo de forma DISTINCT

```sql
SELECT
    COUNT(DISTINCT country) AS "Quantidade de paises"
FROM
    tb_funcionarios;
```

#### Resumindo:

* **`COUNT(*)`** -> quantidade de linhas da table
* **`COUNT(column1)`** -> quantidade de linhas de determinada column
* **`COUNT(DISTINTIC)`** -> quantidade de dados √∫nicos de determinada column


<br>

‚ö†Ô∏è A function **`COUNT()`** n√£o contabiliza linhas em branco/null. Ele s√≥ vai contar valores preenchidos.

<br>
<hr>


### SUM
Some todas as rows de uma column


:pencil2: Fa√ßa uma query e **some** todos os sal√°rios dos funcion√°rios '**Dev Pleno**' e '**Dev Senior**'

```sql
SELECT
    SUM(salary) AS "Sal√°rio total"
FROM
    tb_funcionarios
WHERE
    role IN ('Dev Pleno','Dev Senior');
```

<br>
<hr>


### Combinando functions

:pencil2: Fa√ßa uma query e traga a **m√©dia**, **maior** sal√°rio, **menor** sal√°rio e a **soma** dos sal√°rios de todos os '**Dev Pleno**':


```sql
SELECT
    MIN(d.salary) "Menor sal√°rio",
    MAX(d.salary) "Maior sal√°rio",
    ROUND(AVG(d.salary), 2) "M√©dia sal√°rio",
    SUM(d.salary) "Soma dos sal√°rios - Dev Pleno"
FROM
    tb_devs d
WHERE
    d.role = 'Dev Pleno';
```

Essas **'aggregate functions'** funcionam melhor utilizando a **clause** `GROUP BY` que veremos a seguir:

<!-- Next Page Button -->
<a href="https://github.com/lGabrielDev/06.postgreSQL/blob/main/2.praticando/15.group_by.md">
    <img alt="√çcone de uma seta apontada para direita, representando um link para a pr√≥xima p√°gina" src="https://cdn-icons-png.flaticon.com/512/8875/8875266.png" width="50px" height="50px" align="right">
</a>